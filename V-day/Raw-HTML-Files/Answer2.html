<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=7">
    <title>Answer2</title>
    <style>
        body { font-family: Arial, Helvetica, sans-serif; margin:0; padding:0; background-color:#ffd1e6; text-align:center; }
        .container { position:relative; height:70vh; }
        .message { text-align:center; margin-top:2rem; }
        .yes { position: absolute; top:50%; left:50%; transform:translate(-50%,-50%); background:#28a745; color:white; border:none; padding:14px 26px; border-radius:8px; cursor:pointer; font-size:18px; }
        .no { position: absolute; background:#dc3545; color:white; border:none; padding:14px 26px; border-radius:8px; cursor:pointer; font-size:18px; }
        .btn:focus { outline:none; }
    </style>
</head>
<body>

    <h1 class="center typewriter">I'm so excited to be with you on Valentine's Day! ❤️</h1>

    <h1 class="center typewriter">Will you be my Valentine?</h1>

    <div class="image-wrap">
        <img id="cycleImg" src="" alt="cycle" style="max-width:45%; max-height:45vh; width:auto; height:auto; display:block; margin:1rem auto; border-radius:8px;" />
    </div>

    <div class="container" id="stage">
        <div class="message">
            <button class="yes btn" id="yesBtn">Yes</button>
            <button class="no btn" id="noBtn">No</button>
        </div>
    </div>

    <script src="typewriter.js"></script>
    <script>
        // Keep Yes button at the same center position as Answer1
        document.getElementById('yesBtn').addEventListener('click', function(){
            window.location.href = 'yes.html';
        });

        // Keep Yes button at the same center position as Answer1
        document.getElementById('yesBtn').addEventListener('click', function(){
            try { localStorage.setItem('yesClicked', '1'); } catch(e){}
            window.location.href = 'yes.html';
        });

        // Cycle images 2-5 when No is clicked; also keep No button placed randomly
        function placeNoRandomly(){
            const stage = document.getElementById('stage');
            const no = document.getElementById('noBtn');
            const rect = stage.getBoundingClientRect();
            const btnW = no.offsetWidth;
            const btnH = no.offsetHeight;
            const padding = 8;
            const maxLeft = Math.max(0, rect.width - btnW - padding);
            const maxTop = Math.max(0, rect.height - btnH - padding);
            const left = Math.floor(Math.random() * maxLeft) + padding;
            const top = Math.floor(Math.random() * maxTop) + padding;
            no.style.left = left + 'px';
            no.style.top = top + 'px';
        }

        function getNoIndex(){
            let idx = 2;
            try { idx = parseInt(localStorage.getItem('noIndex') || '2', 10); } catch(e){}
            if (isNaN(idx) || idx < 2 || idx > 5) idx = 2;
            return idx;
        }

        function setNoIndex(idx){
            if (idx < 2) idx = 2;
            if (idx > 5) idx = 2;
            try { localStorage.setItem('noIndex', String(idx)); } catch(e){}
        }

        function showCycleImage(){
            const idx = getNoIndex();
            const src = '../contents/' + idx + (idx===5 ? '.gif' : '.jpg');
            document.getElementById('cycleImg').src = src;
        }

        window.addEventListener('load', function(){
            showCycleImage();
            placeNoRandomly();
            window.addEventListener('resize', placeNoRandomly);
        });

        document.getElementById('noBtn').addEventListener('click', function(){
            // advance to next image in cycle 2->3->4->5->2...
            let idx = getNoIndex();
            idx = (idx >=5) ? 2 : idx + 1;
            setNoIndex(idx);
            showCycleImage();
            placeNoRandomly();
        });
    </script>

</body>
</html>
